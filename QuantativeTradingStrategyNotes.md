# 经典量化交易策略笔记
#### Author：SIMON  
#### Date：JULY 2021

***

## MIST：有用资源传送门
* Python量化交易笔记（偏实操，主要看策略的python实现逻辑）：<https://blog.csdn.net/m0_46603114/category_9820181.html>


***

## 0. FUNDATIONS

### 0.1 $\alpha$

任何一个投资策略的收益率都可以分为两部分：  
1. 与市场基准完全相关  
2. 与市场基准不相关。

Alpha的含义如下：
```
与市场不相关的（非系统性风险）就是Alpha（与投资产品表现与投资者自主策略水平有关）, 主要反应**超额收益水平**，应当越大越好。
```
因此，当阿尔法为正时即为正常超越，阿尔法为负时即为反向超越。


### 0.2 $\beta$
而Beta则与Alpha相反，含义如下：
```
Beta反映**系统性风险**，贝塔反映的是弹性、市场波动性，换句话说，就是资产的收益对市场波动的敏感度，应当越小越好。
```

而**Beta收益就是与市场完全相关的那部分收益**。相对来说Beta收益更容易获得，比如持有成本低廉的指数基金。所以我们可以看出，策略收益相对重要的组成部分就是Alpha收益。

在进行投资组合建立时，市场行情决定了对贝塔的选择。在上涨的行情中，量化投资人利用贝塔值比较高的基金可以得到较高市场上涨带来的盈利。在不算明朗的行情中，贝塔值较低的基金可以更好的进行防御。

### 0.3 $\alpha$ vs $\beta$
对于基金多头的交易者来说，不管市场行情如何，阿尔法都是越大越好，交易者都希望能够获得正的超额收益。但是当市场行情下跌时，即使是拥有高超基金选择能力的交易者都抵挡不住市场下跌带来的损失。因此对于希望获得绝对收益的投资者来说，单边持有基金很难避免系统性的风险,这时阿尔法对冲策略为投资人获取绝对收益提供了可能。

保留超额收益，冲掉所有系统性风险是阿尔法策略的基本思想。执行该策略的投资人只要选择较高阿尔法的基金就可以了，并且不用担心市场的行为，因为此时的系统风险已经完全实现对冲。

我们都知道对冲是具有两面性，**一方面如果未来一段时间行情上涨，投资人不会获得收益，另一方面，如果行情下跌，投资人则能够避免市场下跌的风险**。

贝塔和阿尔法值的稳定性绝对了阿尔法策略是否有效。只有当他们两个的值都相对稳定的时候，预期收益才会比较确定。
阿尔法策略一般被应用在市场效率相对较弱的市场上。因为从以往的经验来看。在强式有效的市场，一般不存在或者很难寻找稳定的alpha。

***

## 1. 双均线策略

Granville 八大法则其中有四条是用于判断买进时机，另外四条是用于判断卖出时机。买进和卖出法则一一对应，分布在高点的左右两侧（除买4和卖4以外）。法则内容如下所示：

* 买1：**均线整体上行，股价由下至上上穿均线**，此为*黄金交叉*，形成第一个买点。
* 买2：股价出现下跌迹象，**但尚未跌破均线**，此时均线变成支撑线，形成第二个买点。
* 买3：股价**仍处于均线上方，但呈现急剧下跌趋势。当跌破均线**时，出现第三个买点。
* 买4：（右侧）**股价和均线都处于下降通道，且股价处于均线下方**，严重远离均线，出现第四个买点。

* 卖1：**均线由上升状态变为缓慢下降的状态，股价也开始下降。当股价跌破均线**时，此为*死亡交叉*，形成第一个卖点。
* 卖2：**股价仍处于均线之下，但股价开始呈现上涨趋势**，当股价无限接近均线但尚未突破时，此时均线变成*阻力线*，形成第二个卖点。
* 卖3：股价终于突破均线，处于均线上方。但**持续时间不长，股价开始下跌，直至再一次跌破均线**，此为第三个卖点。
* 卖4：（左侧）股价和均线都在上涨，股价上涨的速度远快于均线上涨的速度。当**股价严重偏离均线**时，出现第四个卖点。

![双均线策略示意图](https://www.myquant.cn/uploads/202010/attach_16402fcc49ff5d9b.jpg)[^1]

[^1]:浅蓝色折线为短期均线；深蓝色平滑曲线为长期均线；橙色为“真实”股价曲线。



参考传送门<https://www.myquant.cn/docs/python_strategyies/153>

***

## 2. Alpha对冲策略

### 2.1 策略原理相关背景：CAPM

CAPM即资本资产定价模型（Capital Asset Pricing Model）。CAPM模型于1964年被Willian Sharpe等人提出。Sharpe等人认为，假设市场是均衡的，资产的预期超额收益率就由市场收益超额收益（alpha）和风险暴露（beta）决定的：

$$
E[r_p] = r_f + \beta_p(E[r_m] - r_f) \tag{1}
$$

其中，$r_p$为自家产品组合回报率（超额收益率，即“超出由于市场这种系统性水平导致的收益”），$E[R_p]$是**预期超额收益率**（$r_p$的数学期望），$r_f$是无风险收益率，$\beta_p$为自己产品组合的beta（风险）值，$E[r_m]$为市场所有产品的平均回报率。  

根据CAPM模型可知，**投资组合的预期收益**由两部分组成，一部分为无风险收益率$r_f$，另一部分为风险收益率(beta项)。  

应当指出，上面的式子仅仅是阐述投资组合收益来源的理论分析，不是策略本身！  

下面是一个对CAPM的通俗解释：
```
首先，为什么要加上一个无风险回报率？作为一个投资者来说，期望回报率一定要大于无风险回报率的，这个很容易理解。什么是无风险回报率？比如在中国来说，我们可以假定在银行存个5年定期是无风险的，当然，这个无风险回报率也是因人而异的，没有一个特定指数（比如你也可以选10年定期）。

然后我们看 用市场所有股票的平均回报率减去无风险回报率，我们叫它市场期望回报率。你想
一下为什么要有这个式子存在呢？因为作为一个投资者，我们一定会在投资之前考虑为什么放弃无风险投资而选择投资股票吧？再通俗一点，为什么我们不拿钱存定期，而把钱投进股市呢？是因为股市的回报高呀！那到底高多少呢？用市场平均回报率减一下定期利率啊。所以如果 为负值，那意味着什么？意味着把钱投入股市，还不如存定期。这个账很好算，所以一旦为负，后面的计算就没有意义了。

好，那贝塔值的意义是什么呢？贝塔值是用来衡量个别投资工具与市场的波动情况。说人话呢就是，这只股票的波动性，用波动性看风险。如果贝塔值是1呢，就是说大盘涨多少，这只股票就涨多少，是完全一致的。如果贝塔值大于1呢，就是说这只股票的波动是大于市场平均值的。如果贝塔值小于1则意味着这只股票波动小于市场平均值。要知道，在金融学里如何衡量一只股票的风险就是利用波动性。波动性为什么被用来作为衡量风险的标志之一呢？假设啊，假设有一只股票，每天不是跌停，就是涨停，而大盘很正常。这样的股票波动性很大，风险是不是也很大？贝塔值呢，就是这样一个用来衡量某只特定股票风险的指数。

作为一个投资者，首先，要保证我们投资的股票回报率一定一定是大于定期的。其次，股票市场整体也要比无风险利率高。最后怎样体现我选的这只股票的风险呢？用贝塔值。这样用贝塔值乘以市场的期望回报率，再加上无风险利率，就能得到我想要的这只股票的期望回报率啦


如何通俗易懂地解释 CAPM 理论？ - Amelie的回答 - 知乎
https://www.zhihu.com/question/28282744/answer/56312706
```

### 2.2 基于CAPM引入alpha项
CAPM模型表示的是在均衡状态下市场的情况，但市场并不总是处于均衡状态，个股总会获得超出市场基准水平的收益，即在CAPM模型的右端总是存在一个alpha项。 

为了解决这个问题，1968年，美国经济学家迈克·詹森（Michael Jensen）提出了詹森指数来描述这个alpha，因此又称**alpha指数**。将(1)式中的$E[r_p]$改写为$r_p$，以及加入了alpha收益项$\alpha_p$后再整理即可获得alpha指数的定义：
$$
\alpha_p = r_p - r_f - \beta_p(E[r_m] - r_f) \tag{2}
$$

将上面的式子(2)的无风险收益去掉，（非预期）**产品超额收益**：
$$
r_p = \alpha_p + \beta_p(E[r_m] - r_f) \tag{3}
$$
其中:
$$
\beta_p = \frac{\text{cov}(r_p,r_m)}{\sigma_p\sigma_m}
$$
由此可见，可将投资组合的收益拆分为alpha收益和beta收益。

### 2.3 ALPHA对冲策略
$\beta$是由市场决定的，属于系统性风险，与投资者管理能力无关，只与投资组合与市场的关系有关。当市场整体下跌时，$\beta$对应的收益也会随着下跌（假设$\beta$为正）。alpha收益与市场无关，是**投资者自身能力的体现**。投资者通过自身的经验进行选股择时，得到超过市场的收益。  

当投资市场处于熊市或者非稳健市场时（beta值很大也即系统性风险很大，因此beta收益期望$\beta_p(E[r_m] - r_f)$为很大的负值），投资者将希望规避掉市场风险（将beta负收益尽可能缩小）、以及提高alpha收益以满足所期望的回报率。  

因此，我们希望：
* 对冲$\beta$收益
* 做大$\alpha$收益

也即，alpha对冲策略将市场性风险对冲掉，只剩下alpha收益，因而**整体收益（几乎）完全取决于投资者自身的能力水平，与市场无关**。


计算阿尔法需要用到CAPM模型，它是由William Sharpe在其著作《投资组合理论与资本市场》中提出，它指出了投资者在市场中交易面临系统性风险和非系统性风险。传统阿尔法策略是在基金经理建立了beta部位的头寸[^2]后，通过衍生品对冲beta部位的风险，从而获得正的阿尔法收益。

阿尔法策略的思想是通过衍生品来对冲投资组合的系统风险beta，锁定超额收益alpha。因此首先需要
寻找稳定的alpha，构建alpha组合，进而计算组合的beta，对冲风险。Alpha策略成功的关键就是寻找到
一个超越基准（具有股指期货等做空工具的基准）的策略。比如，可以构造指数增强组合+沪深300指数期
货空头策略。这种策略隐含的投资逻辑是择时比较困难，不想承受市场风险。  

从国内外的经验来看，在强式有效的市场，一般不存在或者很难寻找稳定的alpha。因此，阿尔法策略
一般运用在市场效率相对较弱的市场上，如新兴股票市 场、创业板市场等。我国的股票市场正是一个新兴的市场，效率相对较低，从过往的经验以及研究来看，的确存在着超额收益alpha。而股指期货， 无疑给我国市场阿尔法策略的运用提供了良好的基础。  

Alpha 策略成败的两个关键要素是：其一，现货组合的超额收益空间有多大；其二，交易成本的高
低。两者相抵的结果，才是 Alpha 策略可获得的利润空间。在股市 Alpha 策略中，最考验策略制定者
水平的因素在于选股方法和能力。

[^2]: 浅头寸亦称“头衬”，意即款项。旧时中国商业、银钱业惯用语。银行、钱庄和企业为了保证收支平衡，每日要对可以收进或需要支出的款项进行预测估算，看能否平衡。这种预算活动称为“轧头寸”。如预计当日全部收入大于支出，即为“多头寸”，亦称“多单”；如需支付的款项大于收入款项，即为“缺头寸”，亦称“缺单”。头寸经轧算后有“多头寸”，可把收大于支的余额出借；如“缺寸头”，则应设法拆进或借入款项 (俗称“调头寸”)，以资轧平。

参考传送门<https://www.myquant.cn/docs/python_strategyies/101>